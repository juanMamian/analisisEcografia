(function(e){function i(i){for(var a,t,r=i[0],l=i[1],c=i[2],d=0,h=[];d<r.length;d++)t=r[d],Object.prototype.hasOwnProperty.call(s,t)&&s[t]&&h.push(s[t][0]),s[t]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);u&&u(i);while(h.length)h.shift()();return o.push.apply(o,c||[]),n()}function n(){for(var e,i=0;i<o.length;i++){for(var n=o[i],a=!0,r=1;r<n.length;r++){var l=n[r];0!==s[l]&&(a=!1)}a&&(o.splice(i--,1),e=t(t.s=n[0]))}return e}var a={},s={app:0},o=[];function t(i){if(a[i])return a[i].exports;var n=a[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,t),n.l=!0,n.exports}t.m=e,t.c=a,t.d=function(e,i,n){t.o(e,i)||Object.defineProperty(e,i,{enumerable:!0,get:n})},t.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,i){if(1&i&&(e=t(e)),8&i)return e;if(4&i&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&i&&"string"!=typeof e)for(var a in e)t.d(n,a,function(i){return e[i]}.bind(null,a));return n},t.n=function(e){var i=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,i){return Object.prototype.hasOwnProperty.call(e,i)},t.p="/analisisDoppler/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],l=r.push.bind(r);r.push=i,r=r.slice();for(var c=0;c<r.length;c++)i(r[c]);var u=l;o.push([0,"chunk-vendors"]),n()})({0:function(e,i,n){e.exports=n("56d7")},"034f":function(e,i,n){"use strict";n("85ec")},"4b50":function(e,i){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAABm1BMVEUAAAB9fX2jo6NeXl6Pj4+Pj4+ioqIvLy82NjY1NTWMjIxLS0tra2uOjo4tLS1VVVWioqJXV1ehoaGhoaFdXV2Li4s5OTl5eXksLCwaGhpTU1MdHR17e3uOjo5BQUGOjo4vLy9UVFSOjo4dHR0wMDCPj49nZ2dDQ0MfHx9paWkyMjI+Pj4mJiY3NzcdHR17e3tqamqOjo6Ojo56enqgoKA7OztpaWmQkJChoaFPT08mJiY9PT2NjY2Pj49/f3+fn5+lpaVoaGh6enp7e3sdHR1oaGhTU1NBQUEvLy9UVFR7e3t7e3saGhpoaGg+Pj4dHR1qamp7e3tCQkJCQkKPj498fHweHh5paWmPj49paWlCQkJnZ2dVVVV9fX0vLy9nZ2d7e3tUVFQfHx9ra2t8fHxVVVVERERERERqampAQECPj49DQ0MzMzNVVVV6enpVVVVpaWl6enpFRUUmJiYaGhpmZmZTU1NTU1MyMjJ7e3ufn596enqPj493d3d8fHwbGxukpKRoaGhUVFQrKysaGhp7e3s/Pz8+Pj49PT291zY1AAAAgXRSTlMABlYN4txVHhcSEQoD4N6UUDAuJxgLB/39+/ba2NfHxcS7qKSej4mBdm1sZmBaWlZWUEtJSEdAOjc2NDEpHBoYCPz49vXv7+/s6+bl5ODg09HKwby7u7u6ubGwrKinp6KhoKCWlY2NgoF6eXlzcWxrY2JRT01IQz09PDs2MC8nJSDBqhNCAAABgklEQVRIx+3SRVPDQBTA8VdClTptcZeWCnVX3N3d3d0lJG352GwuDKewb4YZLv3fkskvu/N2odAfZZErkSK2WTXbDpQp5RaAkiae56tidMJZr22Ow9swIRV0y9xrOY5rtsjHBHJNRewcSSsHWzfPN9ENwFVOSL0C4MrmVABVitVyrt8OtAX3juKgcBwHqYVrNJ+vjQKiksUcyYohzKRAdtUYc/CZz/VdAibGWjvlAGRKBlAxBoMaJwzLvQM6E4rsfJDOUKfSIBAdhqh1AjkBTNGGysoNE6Ay3d4xgE4iwYq2pTUPUnSw7MgNRjBzLKkVdTILAtkHTOc9LDseAlSerdYQmP3ul59DTKdFx6gGYLa7yqrd32/MEb3sUQWi+Tuz2ewM+SjhC5PflxaRjOLkooyQ6hR4pzU1hxIwEiGLiJOHQULWJapGaXFxTRje9TKZvhTEO50YWnmCZB0hGh/ZWSBg/PUapV7NZFAtUo10PkEeMxmg7LmlrtGLvdVJFRT6v74ABqxMskl6QHIAAAAASUVORK5CYII="},"56d7":function(e,i,n){"use strict";n.r(i);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),s=function(){var e=this,i=e.$createElement,a=e._self._c||i;return a("div",{attrs:{id:"app"}},[a("div",{attrs:{id:"zonaSelectImagen"}},[a("img",{attrs:{src:n("cf55"),alt:"Cargar imágen",id:"botonUploadEco"},on:{click:function(i){return e.$refs.inputEcografia.click()}}}),a("input",{ref:"inputEcografia",staticStyle:{visibility:"hidden"},attrs:{type:"file",name:"inputEcografia",id:"inputEcografia"},on:{change:e.mostrarImagenSeleccionada}}),a("center",[a("div",{directives:[{name:"show",rawName:"v-show",value:e.imagenSelected,expression:"imagenSelected"}],attrs:{id:"zonaImagenSeleccionada"},on:{click:function(i){return i.ctrlKey?e.iniciarDibujoZonaAnalisis(i):null},mousemove:e.resizeZonaAnalisis,keyup:function(i){return!i.type.indexOf("key")&&e._k(i.keyCode,"left",37,i.key,["Left","ArrowLeft"])||"button"in i&&0!==i.button?null:e.setZonaAnalisis(i)}}},[a("canvas",{directives:[{name:"show",rawName:"v-show",value:e.showContornoEco,expression:"showContornoEco"}],ref:"canvasContorno",attrs:{id:"canvasContorno"}}),a("img",{ref:"imagenSeleccionada",attrs:{draggable:"false",src:"",alt:"Ninguna imágen seleccionada",id:"imagenSeleccionada"}}),a("div",{style:[e.offsetZonaAnalisis],attrs:{id:"zonaAnalisis"}},[a("img",{directives:[{name:"show",rawName:"v-show",value:e.enviandoEco,expression:"enviandoEco"}],staticClass:"simboloLoading",attrs:{src:n("4b50")}}),a("div",{directives:[{name:"show",rawName:"v-show",value:e.respuestaRecibida,expression:"respuestaRecibida"}],attrs:{id:"controlesZonaAnalisis"}},[a("div",{staticClass:"bloqueControl"},[a("label",{staticClass:"labelCheckbox",attrs:{for:"showContornoEco"}},[e._v("Contorno")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.showContornoEco,expression:"showContornoEco"}],staticClass:"checkControlAnalisis",attrs:{type:"checkbox",name:"showContornoEco",id:"showContornoEco"},domProps:{checked:Array.isArray(e.showContornoEco)?e._i(e.showContornoEco,null)>-1:e.showContornoEco},on:{change:function(i){var n=e.showContornoEco,a=i.target,s=!!a.checked;if(Array.isArray(n)){var o=null,t=e._i(n,o);a.checked?t<0&&(e.showContornoEco=n.concat([o])):t>-1&&(e.showContornoEco=n.slice(0,t).concat(n.slice(t+1)))}else e.showContornoEco=s}}})]),a("div",{staticClass:"bloqueControl"},[a("label",{staticClass:"labelCheckbox",attrs:{for:"showMarcasR"}},[e._v("R")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.showMarcasR,expression:"showMarcasR"}],staticClass:"checkControlAnalisis",attrs:{type:"checkbox",name:"showMarcasR",id:"showMarcasR"},domProps:{checked:Array.isArray(e.showMarcasR)?e._i(e.showMarcasR,null)>-1:e.showMarcasR},on:{change:function(i){var n=e.showMarcasR,a=i.target,s=!!a.checked;if(Array.isArray(n)){var o=null,t=e._i(n,o);a.checked?t<0&&(e.showMarcasR=n.concat([o])):t>-1&&(e.showMarcasR=n.slice(0,t).concat(n.slice(t+1)))}else e.showMarcasR=s}}})]),e.variabilidad?a("div",{staticClass:"infoAnalisis",attrs:{id:"infoVariabilidad"}},[e._v(" Variación promedio: "+e._s(e.variabilidad.toFixed(2))+" "),a("br"),e._v(" Ajustada: "+e._s(e.variabilidadAjustada.toFixed(2))+" ")]):e._e(),e.margenError?a("div",{staticClass:"infoAnalisis",attrs:{id:"infoMargenError"}},[e._v(" Margen de error: "+e._s(e.margenError.toFixed(2))+"ms ")]):e._e()]),e._l(e.quiebres,(function(i,n){return a("div",{directives:[{name:"show",rawName:"v-show",value:e.showMarcasR,expression:"showMarcasR"}],key:"quiebre"+n,staticClass:"marcaQuiebre",style:[{left:i.left-1+"px"}]},[a("div",{staticClass:"controlesQuiebre"}),null!=i.intervalo?a("div",{staticClass:"infoQuiebre infoIntervalo"},[e._v(e._s(i.intervalo.toFixed(2))+"ms")]):e._e(),null!=i.intervalo?a("div",{staticClass:"infoQuiebre infoIntervaloAjustado"},[e._v(e._s(i.intervaloAjustado.toFixed(2))+"ms")]):e._e()])})),a("div",{attrs:{id:"lineaMarcasTiempo"}}),a("div",{staticClass:"agarraderoZonaAnalisis",attrs:{id:"agarraderoZonaAnalisis1"},on:{mousedown:function(i){return!i.type.indexOf("key")&&e._k(i.keyCode,"left",37,i.key,["Left","ArrowLeft"])||"button"in i&&0!==i.button?null:e.iniciarResize(0)},mousemove:function(i){return e.resizeZonaAnalisis(0,i)},mouseup:function(i){return!i.type.indexOf("key")&&e._k(i.keyCode,"left",37,i.key,["Left","ArrowLeft"])||"button"in i&&0!==i.button?null:e.endResize(0)}}},[a("div",{directives:[{name:"show",rawName:"v-show",value:1==e.resizingZonaAnalisis[0],expression:"resizingZonaAnalisis[0] == true"}],staticClass:"burbujaHover"})]),a("div",{staticClass:"agarraderoZonaAnalisis",attrs:{id:"agarraderoZonaAnalisis2"},on:{mousedown:function(i){return!i.type.indexOf("key")&&e._k(i.keyCode,"left",37,i.key,["Left","ArrowLeft"])||"button"in i&&0!==i.button?null:e.iniciarResize(1)},mousemove:function(i){return e.resizeZonaAnalisis(1,i)},mouseup:function(i){return!i.type.indexOf("key")&&e._k(i.keyCode,"left",37,i.key,["Left","ArrowLeft"])||"button"in i&&0!==i.button?null:e.endResize(1)}}},[a("div",{directives:[{name:"show",rawName:"v-show",value:1==e.resizingZonaAnalisis[1],expression:"resizingZonaAnalisis[1] == true"}],staticClass:"burbujaHover"})]),a("div",{staticClass:"agarraderoZonaAnalisis",attrs:{id:"agarraderoZonaAnalisis3"},on:{mousedown:function(i){return!i.type.indexOf("key")&&e._k(i.keyCode,"left",37,i.key,["Left","ArrowLeft"])||"button"in i&&0!==i.button?null:e.iniciarResize(2)},mousemove:function(i){return e.resizeZonaAnalisis(2,i)},mouseup:function(i){return!i.type.indexOf("key")&&e._k(i.keyCode,"left",37,i.key,["Left","ArrowLeft"])||"button"in i&&0!==i.button?null:e.endResize(2)}}},[a("div",{directives:[{name:"show",rawName:"v-show",value:1==e.resizingZonaAnalisis[2],expression:"resizingZonaAnalisis[2] == true"}],staticClass:"burbujaHover"})]),a("div",{staticClass:"agarraderoZonaAnalisis",attrs:{id:"agarraderoZonaAnalisis4"},on:{mousedown:function(i){return!i.type.indexOf("key")&&e._k(i.keyCode,"left",37,i.key,["Left","ArrowLeft"])||"button"in i&&0!==i.button?null:e.iniciarResize(3)},mousemove:function(i){return e.resizeZonaAnalisis(3,i)},mouseup:function(i){return!i.type.indexOf("key")&&e._k(i.keyCode,"left",37,i.key,["Left","ArrowLeft"])||"button"in i&&0!==i.button?null:e.endResize(3)}}},[a("div",{directives:[{name:"show",rawName:"v-show",value:1==e.resizingZonaAnalisis[3],expression:"resizingZonaAnalisis[3] == true"}],staticClass:"burbujaHover"})])],2)]),a("br"),a("br"),a("input",{directives:[{name:"show",rawName:"v-show",value:e.imagenSelected,expression:"imagenSelected"},{name:"model",rawName:"v-model",value:e.umbralEco,expression:"umbralEco"}],attrs:{type:"color"},domProps:{value:e.umbralEco},on:{input:function(i){i.target.composing||(e.umbralEco=i.target.value)}}}),a("button",{directives:[{name:"show",rawName:"v-show",value:e.imagenSelected,expression:"imagenSelected"}],ref:"botonEnviarEco",class:{deshabilitado:e.enviandoEco},attrs:{id:"botonEnviarEco"},on:{click:e.uploadEcografia}},[e._v("Analizar")])])],1),e._m(0)])},o=[function(){var e=this,i=e.$createElement,n=e._self._c||i;return n("div",{attrs:{id:"tablaResultados"}},[n("div",{staticClass:"cosa"}),n("div",{staticClass:"valor"})])}],t=(n("cb29"),n("a434"),n("99af"),n("d81d"),n("4de4"),n("bc3a")),r=n.n(t),l={name:"App",data:function(){return{montado:!1,enviandoEco:!1,respuestaAnalisis:null,respuestaRecibida:!1,urlImagenRespuesta:null,quiebres:[],margenError:null,sizeImagenSeleccionada:{x:null,y:null},imagenSelected:!1,posicionesZonaAnalisis:{x1:0,y1:0,x2:0,y2:0},umbralSize:30,resizingZonaAnalisis:[!1,!1,!1,!1],showContornoEco:!0,showMarcasR:!0,umbralEco:"#1B1B1B"}},methods:{setZonaAnalisis:function(){this.resizingZonaAnalisis=!1},vaciarAnalisis:function(){this.quiebres=[];var e=this.$refs.canvasContorno,i=e.getContext("2d");i.clearRect(0,0,e.width,e.height)},iniciarResize:function(e){this.vaciarAnalisis(),this.respuestaRecibida=!1,this.resizingZonaAnalisis.fill(!1),this.resizingZonaAnalisis.splice(e,1,!0)},endResize:function(){this.resizingZonaAnalisis.splice(0,1,!1),this.resizingZonaAnalisis.splice(1,1,!1),this.resizingZonaAnalisis.splice(2,1,!1),this.resizingZonaAnalisis.splice(3,1,!1)},resizeZonaAnalisis:function(e,i){if(this.resizingZonaAnalisis[e]){var n=document.getElementById("zonaImagenSeleccionada").getBoundingClientRect(),a={x:i.clientX-n.left,y:i.clientY-n.top},s="x",o="y";0==e?(s="x1",o="y1"):1==e?(s="x2",o="y1"):2==e?(s="x1",o="y2"):3==e&&(s="x2",o="y2"),this.$set(this.posicionesZonaAnalisis,s,Math.round(a.x)),this.$set(this.posicionesZonaAnalisis,o,Math.round(a.y)),this.posicionesZonaAnalisis.x1<0&&this.$set(this.posicionesZonaAnalisis,"x1",0),this.posicionesZonaAnalisis.x2<this.umbralSize&&this.$set(this.posicionesZonaAnalisis,"x2",this.umbralSize),this.posicionesZonaAnalisis.y1<0&&this.$set(this.posicionesZonaAnalisis,"y1",0),this.posicionesZonaAnalisis.y2<this.umbralSize&&this.$set(this.posicionesZonaAnalisis,"y2",this.umbralSize),this.posicionesZonaAnalisis.x2>n.width&&this.$set(this.posicionesZonaAnalisis,"x2",n.width),this.posicionesZonaAnalisis.y2>n.height&&this.$set(this.posicionesZonaAnalisis,"y2",n.height),this.posicionesZonaAnalisis.x1>this.posicionesZonaAnalisis.x2-this.umbralSize&&this.$set(this.posicionesZonaAnalisis,"x1",this.posicionesZonaAnalisis.x2-this.umbralSize),this.posicionesZonaAnalisis.y1>this.posicionesZonaAnalisis.y2-this.umbralSize&&this.$set(this.posicionesZonaAnalisis,"y1",this.posicionesZonaAnalisis.y2-this.umbralSize)}},mostrarImagenSeleccionada:function(){var e=this.$refs.inputEcografia.files[0],i=this;if(this.imagenSelected=!0,FileReader&&e){this.vaciarAnalisis(),this.respuestaRecibida=!1;var n=new FileReader;n.onload=function(){var e=new Image;e.src=n.result,e.onload=function(){console.log("Size imágen: ".concat(this.width,", ").concat(this.height)),i.$refs.imagenSeleccionada.src=n.result,i.$nextTick((function(){var e=i.$refs.imagenSeleccionada.offsetWidth,n=i.$refs.imagenSeleccionada.offsetHeight;i.$set(i.sizeImagenSeleccionada,"x",e),i.$set(i.sizeImagenSeleccionada,"y",n),i.posicionesZonaAnalisis.x2-i.posicionesZonaAnalisis.x1!=0&&i.posicionesZonaAnalisis.y2-i.posicionesZonaAnalisis.y1!=0||(i.posicionesZonaAnalisis={x1:0,y1:0,x2:e,y2:n}),i.$set(i.posicionesZonaAnalisis,"y2",n)}))}},n.readAsDataURL(e)}},uploadEcografia:function(){if(!this.enviandoEco){var e=document.getElementById("inputEcografia"),i=new FormData,n=e.files[0];i.append("ecografia",n),i.append("posicionesZonaAnalisis",JSON.stringify(this.posicionesZonaAnalisis)),i.append("umbralEco",this.umbralEco),this.enviandoEco=!0;var a=this;r()({method:"post",url:this.serverUrl+"/ecografias/analizarImagen",data:i,headers:{"Content-Type":"multipart/form-data"}}).then((function(e){var i=e.data;a.respuestaRecibida=!0,a.enviandoEco=!1,a.trazarContornoEco(i.linea),a.marcarTiempos(i.marcasTiempo),a.quiebres=i.puntosQuiebre,a.margenError=i.margenError})).catch((function(e){a.enviandoEco=!1,console.log("Error analizando la ecografía. E: ".concat(e))}))}},trazarContornoEco:function(e){var i=document.getElementById("zonaAnalisis"),n=document.getElementById("canvasContorno");n.style.left=i.style.left,n.style.top=i.style.top,n.style.width=i.style.width,n.style.height=i.style.height,n.width=parseInt(i.style.width),n.height=parseInt(i.style.height);var a=n.getContext("2d");a.fillStyle="red";for(var s=0;s<parseInt(i.style.width);s++)a.fillRect(s,e[s],1,1)},marcarTiempos:function(e){var i=document.getElementById("zonaAnalisis").getBoundingClientRect(),n=document.getElementById("canvasContorno"),a=n.getContext("2d");a.fillStyle="yellow";for(var s=0;s<e.length;s++)a.fillRect(e[s],i.height-10,1,7)},marcarQuiebres:function(e){console.log("Trazando quiebres: ".concat(e));var i=document.getElementById("zonaAnalisis").getBoundingClientRect(),n=document.getElementById("canvasContorno"),a=n.getContext("2d");a.fillStyle="green";for(var s=0;s<e.length;s++)a.fillRect(e[s],0,1,i.height)},teclaPresionada:function(e){13===e.which&&this.imagenSelected&&this.$refs.botonEnviarEco.click(),78===e.which&&this.$refs.inputEcografia.click(),82===e.which&&document.getElementById("showMarcasR").click(),67===e.which&&document.getElementById("showContornoEco").click()}},computed:{offsetZonaAnalisis:function(){if(this.montado)return{left:this.posicionesZonaAnalisis.x1+"px",top:this.posicionesZonaAnalisis.y1+"px",width:this.posicionesZonaAnalisis.x2-this.posicionesZonaAnalisis.x1+"px",height:this.posicionesZonaAnalisis.y2-this.posicionesZonaAnalisis.y1+"px"}},variabilidad:function(){var e=this.quiebres.filter((function(e){return e.variacion})).map((function(e){return e.variacion}));return e.length<1?null:e.reduce((function(e,i){return Math.abs(e)+Math.abs(i)}),0)/e.length},variabilidadAjustada:function(){var e=this.quiebres.filter((function(e){return e.variacionAjustada})).map((function(e){return e.variacionAjustada}));return e.length<1?null:e.reduce((function(e,i){return Math.abs(e)+Math.abs(i)}),0)/e.length}},mounted:function(){this.montado=!0,document.addEventListener("keyup",this.teclaPresionada)}},c=l,u=(n("034f"),n("2877")),d=Object(u["a"])(c,s,o,!1,null,null,null),h=d.exports;a["a"].config.productionTip=!1;var f=window.location.href.substring(7,16),p="localhost"!=f?"https://analisisdoppler.herokuapp.com":"http://localhost:3000";a["a"].mixin({data:function(){return{serverUrl:p}}}),new a["a"]({render:function(e){return e(h)}}).$mount("#app")},"85ec":function(e,i,n){},cf55:function(e,i,n){e.exports=n.p+"img/upload.437c244f.png"}});
//# sourceMappingURL=app.72a22c26.js.map